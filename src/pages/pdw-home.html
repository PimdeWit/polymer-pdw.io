<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../experiments/pointer-follower.html">
<link rel="import" href="../experiments/noise-displacer.html">
<!--<link rel="import" href="../experiments/lorem-ipsum/lorem-ipsum.html">-->
<link rel="import" href="../shared-styles.html">

<dom-module id="pdw-home">
  <template>
    <style include="shared-styles">
       :host {
        display: block;

        padding: 10px;
      }

      section {
        position: relative;
        width: 100%;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      pointer-follower {
       width: 40vw;
       height: 40vw; 
      }

      noise-displacer {
        width: 100%;
        height: 100vh;
      }

      .gui {
        position: absolute;
        top: 0;
        right: 0;
        color: #fff;
        background-color: rgba(26, 26, 26, 1);
        padding: 32px;
        display: flex;
        flex-direction: column;
      }
    </style>

    <section>
      <pointer-follower rows="32" columns="32" tag></pointer-follower>
    </section>
    <section>
      <!--<noise-displacer noise-size$="[[noiseSize]]" image="../../images/test/random.jpg"></noise-displacer>-->
      <noise-displacer id="noise-displacer" slice-size$="[[noiseSize]]" noise-x="[[noiseX]]" noise-y="[[noiseY]]"></noise-displacer>
      <div class="gui">
        <h4>Direct Changes</h4>
        <span>Slice Size</span>
        <input id="gui-noise-size" type="range" min="1" max="100" step="1">
        <br>
        <h4>Requires re-init</h4>
        <span>Density X</span>
        <input id="gui-noise-x" type="range" min="1" max="200" step="1">
        <span>Density Y</span>
        <input id="gui-noise-y" type="range" min="1" max="200" step="1">
        <span>Text</span>
        <input id="gui-noise-text" type="text" placholder="text?">

        <button id="gui-noise-reset" type="button">re-init</button>
      </div>
    </section>
    <!--<lorem-ipsum></lorem-ipsum>-->

    <div style="width:50px; height:8000px; background-color: red;"></div>
  </template>

  <script>
    class PdwHome extends Polymer.Element {
      static get is() { return 'pdw-home'; }
      static get properties() {
        return {
          assets: Object,
          NoiseDisplacer: Object,
          GUINoiseReset: HTMLElement,
          GUINoiseSize: HTMLElement,
          GUINoiseX: HTMLElement,
          GUINoiseY: HTMLElement,
          GUINoiseText: HTMLElement,

          noiseSize: {
            type: Number,
            value: 1
          },

          noiseX: {
            type: Number,
            value: 160
          },

          noiseY: {
            type: Number,
            value: 160
          },

          noiseText: {
            type: String,
            value: 'Hello TTR'
          }
        }
      }

      constructor() {
        super();
      }

      connectedCallback() {
        super.connectedCallback();

        this.NoiseDisplacer = this.shadowRoot.querySelector('#noise-displacer');
        this.GUINoiseReset = this.shadowRoot.querySelector('#gui-noise-reset');
        this.GUINoiseSize = this.shadowRoot.querySelector('#gui-noise-size');
        this.GUINoiseX = this.shadowRoot.querySelector('#gui-noise-x');
        this.GUINoiseY = this.shadowRoot.querySelector('#gui-noise-y');
        this.GUINoiseText = this.shadowRoot.querySelector('#gui-noise-text');

        this._addEventListeners();
      }

      _addEventListeners() {
        this._boundNoiseReset = this.onNoiseReset.bind(this);
        this._boundNoiseSizeChange = this.onNoiseSizeChange.bind(this);
        this._boundNoiseXChange = this.onNoiseXChange.bind(this);
        this._boundNoiseYChange = this.onNoiseYChange.bind(this);
        this._boundNoiseTextChange = this.onNoiseTextChange.bind(this);
        this.GUINoiseReset.addEventListener('click', this._boundNoiseReset);
        this.GUINoiseSize.addEventListener('input', this._boundNoiseSizeChange);
        this.GUINoiseX.addEventListener('input', this._boundNoiseXChange);
        this.GUINoiseY.addEventListener('input', this._boundNoiseYChange);
        this.GUINoiseText.addEventListener('change', this._boundNoiseTextChange);
      }

      onNoiseReset() {
        console.log(this.noiseText);
        this.NoiseDisplacer.reset(this.noiseText);
      }

      onNoiseSizeChange() {
        console.log(this.GUINoiseSize.value);
        this.noiseSize = this.GUINoiseSize.value;
      }

      onNoiseXChange() {
        this.noiseX = this.GUINoiseX.value;
      }

      onNoiseYChange() {
        this.noiseY = this.GUINoiseY.value;
      }

      onNoiseTextChange() {
        console.log('iwqdqwkdpokqw');
        this.noiseText = this.GUINoiseText.value;
      }
    }

    window.customElements.define(PdwHome.is, PdwHome);
  </script>
</dom-module>